<!DOCTYPE html>
<html class="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Calculadora Master</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://calculadora-master.vercel.app/">
    <meta property="og:title" content="Calculadora Master">
    <meta property="og:description"
        content="Calculadora Master para √≥ptica - Calcule adi√ß√µes, perto e longe facilmente">
    <meta property="og:image" content="https://calculadora-master.vercel.app/og-image.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://calculadora-master.vercel.app/">
    <meta property="twitter:title" content="Calculadora Master">
    <meta property="twitter:description"
        content="Calculadora Master para √≥ptica - Calcule adi√ß√µes, perto e longe facilmente">
    <meta property="twitter:image" content="https://calculadora-master.vercel.app/og-image.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f26b2b",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        .input-error {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }

        /* Custom Dropdown Styles */
        .custom-dropdown {
            position: relative;
            width: 100%;
            overflow: visible;
        }

        .dropdown-trigger {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0.75rem;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
            color: #0f172a;
        }

        .dropdown-trigger:hover {
            border-color: #f26b2b;
            background: #fff7ed;
        }

        .dropdown-trigger:focus {
            outline: none;
            border-color: #f26b2b;
            box-shadow: 0 0 0 3px rgba(242, 107, 43, 0.1);
        }

        .dropdown-trigger.dark {
            background: #1e293b;
            border-color: #334155;
            color: #f1f5f9;
        }

        .dropdown-trigger.dark:hover {
            border-color: #f26b2b;
            background: #334155;
        }

        .dropdown-arrow {
            transition: transform 0.2s;
            font-size: 0.75rem;
            color: #64748b;
        }

        .dropdown-trigger.open .dropdown-arrow {
            transform: rotate(180deg);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-top: 0.25rem;
        }

        .dropdown-menu.open {
            display: block;
        }

        .dropdown-menu.dark {
            background: #1e293b;
            border-color: #334155;
        }

        .dropdown-section {
            border-bottom: 1px solid #e2e8f0;
        }

        .dropdown-menu.dark .dropdown-section {
            border-bottom-color: #334155;
        }

        .dropdown-section:last-child {
            border-bottom: none;
        }

        .section-header {
            padding: 0.5rem 0.75rem;
            font-size: 0.7rem;
            font-weight: 600;
            color: #64748b;
            background: #f1f5f9;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .dropdown-menu.dark .section-header {
            background: #334155;
            color: #94a3b8;
        }

        .dropdown-options {
            display: flex;
            flex-direction: column;
            gap: 0.125rem;
            padding: 0.25rem 0.5rem;
        }

        .dropdown-option {
            padding: 0.5rem 0.25rem;
            cursor: pointer;
            transition: background-color 0.15s;
            text-align: center;
            font-size: 0.8125rem;
            border-radius: 0.25rem;
            color: #0f172a;
        }

        .dropdown-option:hover {
            background-color: #f26b2b;
            color: white;
        }

        .dropdown-option.selected {
            background-color: #f26b2b;
            color: white;
            font-weight: 500;
        }

        .dropdown-menu.dark .dropdown-option {
            color: #f1f5f9;
        }

        /* Scrollbar styling */
        .dropdown-menu::-webkit-scrollbar {
            width: 8px;
        }

        .dropdown-menu::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .dropdown-menu::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .dropdown-menu::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .dropdown-menu.dark::-webkit-scrollbar-track {
            background: #1e293b;
        }

        .dropdown-menu.dark::-webkit-scrollbar-thumb {
            background: #475569;
        }

        .dropdown-menu.dark::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Ensure dropdown menus can overflow parent containers */
        .calc-block {
            overflow: visible !important;
        }

        .custom-dropdown .dropdown-menu {
            /* Ensure dropdown menu extends beyond parent */
            position: absolute;
            width: 100%;
            min-width: 200px;
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-white antialiased min-h-screen flex flex-col">
    <header
        class="flex items-center justify-between whitespace-nowrap border-b border-solid border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 px-4 sm:px-6 py-4 sticky top-0 z-50 shadow-sm">
        <div class="flex items-center gap-2 sm:gap-3 text-slate-900 dark:text-white">
            <div class="flex items-center">
                <img src="logo master  150x40.png" alt="Master Logo" class="h-8 sm:h-12 w-auto object-contain" />
            </div>
            <div class="h-6 w-px bg-slate-300 dark:bg-slate-700 mx-1 sm:mx-2"></div>
            <h2 class="text-base sm:text-lg font-medium text-slate-600 dark:text-slate-300">Calculadora</h2>
        </div>
        <button id="resetAllBtn"
            class="flex min-w-[60px] sm:min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-8 sm:h-10 px-2 sm:px-4 bg-slate-100 hover:bg-slate-200 dark:bg-slate-800 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 text-xs sm:text-sm font-bold leading-normal transition-colors duration-200 gap-1 sm:gap-2">
            <span class="material-symbols-outlined !text-[16px] sm:!text-[18px]">restart_alt</span>
            <span class="truncate hidden sm:inline">Atualizar</span>
        </button>
    </header>

    <!-- Mobile/Tablet Dropdown Selector -->
    <div class="lg:hidden px-4 py-4 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800">
        <label for="calcSelector" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
            Selecione o c√°lculo:
        </label>
        <select id="calcSelector"
            class="w-full rounded-lg border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-primary h-10 px-3">
            <option value="adicao" selected>C√°lculo de Adi√ß√£o</option>
            <option value="perto">C√°lculo de Perto</option>
            <option value="longe">C√°lculo de Longe</option>
        </select>
    </div>

    <main class="flex-1 p-4 lg:p-8 overflow-y-auto">
        <div class="max-w-[1400px] mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- C√°lculo de Adi√ß√£o -->
            <div id="calc-adicao"
                class="calc-block hidden lg:flex flex-col bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden">
                <div class="px-6 py-5 border-b border-slate-100 dark:border-slate-800 flex items-center gap-3">
                    <span class="bg-primary/10 text-primary p-2 rounded-lg material-symbols-outlined">add_circle</span>
                    <div>
                        <h3 class="text-lg font-bold text-slate-900 dark:text-white">C√°lculo de Adi√ß√£o</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-xs font-medium mt-0.5">Longe + Perto = Adi√ß√£o
                        </p>
                    </div>
                </div>
                <div class="p-6 flex flex-col gap-6 flex-1">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <h4
                                class="text-sm font-bold text-slate-900 dark:text-slate-200 mb-3 flex items-center gap-2">
                                <span class="material-symbols-outlined text-base text-primary">distance</span>
                                Longe
                            </h4>
                            <div class="grid grid-cols-1 gap-3">
                                <label class="flex flex-col">
                                    <span class="text-xs font-medium text-slate-500 mb-1.5 ml-1">Esf√©rico</span>
                                    <div class="custom-dropdown" data-dropdown-id="addLongeInput">
                                        <button class="dropdown-trigger" type="button">
                                            <span class="selected-value">0,00</span>
                                            <span class="dropdown-arrow">‚ñº</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-section">
                                                <div class="section-header">NEGATIVOS</div>
                                                <div class="dropdown-options" id="addLongeNegatives"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">ZERO</div>
                                                <div class="dropdown-options" id="addLongeZero"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">POSITIVOS</div>
                                                <div class="dropdown-options" id="addLongePositives"></div>
                                            </div>
                                        </div>
                                        <input type="hidden" id="addLongeInput" value="0.00" />
                                    </div>
                                    <div id="addLongeError" class="error-message text-red-500 text-xs mt-1 hidden">Valor
                                        inv√°lido</div>
                                </label>
                            </div>
                        </div>
                        <div>
                            <h4
                                class="text-sm font-bold text-slate-900 dark:text-slate-200 mb-3 flex items-center gap-2">
                                <span class="material-symbols-outlined text-base text-primary">menu_book</span>
                                Perto
                            </h4>
                            <div class="grid grid-cols-1 gap-3">
                                <label class="flex flex-col">
                                    <span class="text-xs font-medium text-slate-500 mb-1.5 ml-1">Esf√©rico</span>
                                    <div class="custom-dropdown" data-dropdown-id="addPertoInput">
                                        <button class="dropdown-trigger" type="button">
                                            <span class="selected-value">0,00</span>
                                            <span class="dropdown-arrow">‚ñº</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-section">
                                                <div class="section-header">NEGATIVOS</div>
                                                <div class="dropdown-options" id="addPertoNegatives"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">ZERO</div>
                                                <div class="dropdown-options" id="addPertoZero"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">POSITIVOS</div>
                                                <div class="dropdown-options" id="addPertoPositives"></div>
                                            </div>
                                        </div>
                                        <input type="hidden" id="addPertoInput" value="0.00" />
                                    </div>
                                    <div id="addPertoError" class="error-message text-red-500 text-xs mt-1 hidden">Valor
                                        inv√°lido</div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <button id="calcAddBtn"
                        class="w-full bg-primary hover:bg-[#d9581f] text-white font-bold py-3 rounded-lg shadow-sm transition-colors flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined">calculate</span>
                        Calcular Adi√ß√£o
                    </button>
                    <div
                        class="p-4 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20 flex flex-col items-center justify-center text-center h-24">
                        <span
                            class="text-slate-500 dark:text-slate-400 text-xs uppercase tracking-widest font-semibold mb-1">Resultado</span>
                        <div id="addResult" class="text-3xl font-bold text-primary">
                            ADD +0,00
                        </div>
                    </div>
                </div>
            </div>
            <!-- C√°lculo de Perto -->
            <div id="calc-perto"
                class="calc-block hidden lg:flex flex-col bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden">
                <div class="px-6 py-5 border-b border-slate-100 dark:border-slate-800 flex items-center gap-3">
                    <span class="bg-primary/10 text-primary p-2 rounded-lg material-symbols-outlined">menu_book</span>
                    <div>
                        <h3 class="text-lg font-bold text-slate-900 dark:text-white">C√°lculo de Perto</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-xs font-medium mt-0.5">Longe + Adi√ß√£o = Perto
                        </p>
                    </div>
                </div>
                <div class="p-6 flex flex-col gap-6 flex-1">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <h4
                                class="text-sm font-bold text-slate-900 dark:text-slate-200 mb-3 flex items-center gap-2">
                                <span class="material-symbols-outlined text-base text-primary">distance</span>
                                Longe
                            </h4>
                            <div class="grid grid-cols-1 gap-3">
                                <label class="flex flex-col">
                                    <span class="text-xs font-medium text-slate-500 mb-1.5 ml-1">Esf√©rico</span>
                                    <div class="custom-dropdown" data-dropdown-id="nearLongeInput">
                                        <button class="dropdown-trigger" type="button">
                                            <span class="selected-value">0,00</span>
                                            <span class="dropdown-arrow">‚ñº</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-section">
                                                <div class="section-header">NEGATIVOS</div>
                                                <div class="dropdown-options" id="nearLongeNegatives"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">ZERO</div>
                                                <div class="dropdown-options" id="nearLongeZero"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">POSITIVOS</div>
                                                <div class="dropdown-options" id="nearLongePositives"></div>
                                            </div>
                                        </div>
                                        <input type="hidden" id="nearLongeInput" value="0.00" />
                                    </div>
                                    <div id="nearLongeError" class="error-message text-red-500 text-xs mt-1 hidden">
                                        Valor
                                        inv√°lido</div>
                                </label>
                            </div>
                        </div>
                        <div>
                            <h4
                                class="text-sm font-bold text-slate-900 dark:text-slate-200 mb-3 flex items-center gap-2">
                                <span class="material-symbols-outlined text-base text-primary">add_circle</span>
                                Adi√ß√£o
                            </h4>
                            <div class="grid grid-cols-1">
                                <label class="flex flex-col">
                                    <span class="text-xs font-medium text-slate-500 mb-1.5 ml-1">Valor da Adi√ß√£o</span>
                                    <div class="custom-dropdown" data-dropdown-id="nearAddInput">
                                        <button class="dropdown-trigger" type="button">
                                            <span class="selected-value">0,00</span>
                                            <span class="dropdown-arrow">‚ñº</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-section">
                                                <div class="section-header">ZERO</div>
                                                <div class="dropdown-options" id="nearAddZero"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">POSITIVOS</div>
                                                <div class="dropdown-options" id="nearAddPositives"></div>
                                            </div>
                                        </div>
                                        <input type="hidden" id="nearAddInput" value="0.00" />
                                    </div>
                                    <div id="nearAddError" class="error-message text-red-500 text-xs mt-1 hidden">Valor
                                        inv√°lido</div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <button id="calcNearBtn"
                        class="w-full bg-primary hover:bg-[#d9581f] text-white font-bold py-3 rounded-lg shadow-sm transition-colors flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined">calculate</span>
                        Calcular Perto
                    </button>
                    <div
                        class="p-4 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20 flex flex-col items-center justify-center text-center h-24">
                        <span
                            class="text-slate-500 dark:text-slate-400 text-xs uppercase tracking-widest font-semibold mb-1">Resultado
                            (Rx Perto)</span>
                        <div id="nearResult" class="text-3xl font-bold text-primary">
                            +0,00
                        </div>
                    </div>
                </div>
            </div>
            <!-- C√°lculo de Longe -->
            <div id="calc-longe"
                class="calc-block hidden lg:flex flex-col bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden">
                <div class="px-6 py-5 border-b border-slate-100 dark:border-slate-800 flex items-center gap-3">
                    <span class="bg-primary/10 text-primary p-2 rounded-lg material-symbols-outlined">distance</span>
                    <div>
                        <h3 class="text-lg font-bold text-slate-900 dark:text-white">C√°lculo de Longe</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-xs font-medium mt-0.5">Perto - Adi√ß√£o = Longe
                        </p>
                    </div>
                </div>
                <div class="p-6 flex flex-col gap-6 flex-1">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <h4
                                class="text-sm font-bold text-slate-900 dark:text-slate-200 mb-3 flex items-center gap-2">
                                <span class="material-symbols-outlined text-base text-primary">menu_book</span>
                                Perto
                            </h4>
                            <div class="grid grid-cols-1 gap-3">
                                <label class="flex flex-col">
                                    <span class="text-xs font-medium text-slate-500 mb-1.5 ml-1">Esf√©rico</span>
                                    <div class="custom-dropdown" data-dropdown-id="farPertoInput">
                                        <button class="dropdown-trigger" type="button">
                                            <span class="selected-value">0,00</span>
                                            <span class="dropdown-arrow">‚ñº</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-section">
                                                <div class="section-header">NEGATIVOS</div>
                                                <div class="dropdown-options" id="farPertoNegatives"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">ZERO</div>
                                                <div class="dropdown-options" id="farPertoZero"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">POSITIVOS</div>
                                                <div class="dropdown-options" id="farPertoPositives"></div>
                                            </div>
                                        </div>
                                        <input type="hidden" id="farPertoInput" value="0.00" />
                                    </div>
                                    <div id="farPertoError" class="error-message text-red-500 text-xs mt-1 hidden">Valor
                                        inv√°lido</div>
                                </label>
                            </div>
                        </div>
                        <div>
                            <h4
                                class="text-sm font-bold text-slate-900 dark:text-slate-200 mb-3 flex items-center gap-2">
                                <span class="material-symbols-outlined text-base text-primary">add_circle</span>
                                Adi√ß√£o
                            </h4>
                            <div class="grid grid-cols-1">
                                <label class="flex flex-col">
                                    <span class="text-xs font-medium text-slate-500 mb-1.5 ml-1">Valor da Adi√ß√£o</span>
                                    <div class="custom-dropdown" data-dropdown-id="farAddInput">
                                        <button class="dropdown-trigger" type="button">
                                            <span class="selected-value">0,00</span>
                                            <span class="dropdown-arrow">‚ñº</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-section">
                                                <div class="section-header">ZERO</div>
                                                <div class="dropdown-options" id="farAddZero"></div>
                                            </div>
                                            <div class="dropdown-section">
                                                <div class="section-header">POSITIVOS</div>
                                                <div class="dropdown-options" id="farAddPositives"></div>
                                            </div>
                                        </div>
                                        <input type="hidden" id="farAddInput" value="0.00" />
                                    </div>
                                    <div id="farAddError" class="error-message text-red-500 text-xs mt-1 hidden">Valor
                                        inv√°lido</div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <button id="calcFarBtn"
                        class="w-full bg-primary hover:bg-[#d9581f] text-white font-bold py-3 rounded-lg shadow-sm transition-colors flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined">calculate</span>
                        Calcular Longe
                    </button>
                    <div
                        class="p-4 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20 flex flex-col items-center justify-center text-center h-24">
                        <span
                            class="text-slate-500 dark:text-slate-400 text-xs uppercase tracking-widest font-semibold mb-1">Resultado
                            (Rx Longe)</span>
                        <div id="farResult" class="text-3xl font-bold text-primary">
                            +0,00
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manual de C√°lculo Section -->
        <section class="mt-12 max-w-[1400px] mx-auto px-4 lg:px-8" aria-labelledby="manual-calculo">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-primary/10 text-primary p-2 rounded-lg material-symbols-outlined"
                    aria-hidden="true">menu_book</span>
                <h2 id="manual-calculo" class="text-2xl font-bold text-slate-900 dark:text-white">Manual de C√°lculo</h2>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Manual Block 1: C√°lculo da Adi√ß√£o -->
                <div id="manual-adicao"
                    class="manual-block hidden lg:block bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800">
                    <div class="px-6 py-4 border-b border-slate-100 dark:border-slate-800">
                        <h3 class="font-bold text-lg text-slate-900 dark:text-white">C√°lculo da Adi√ß√£o</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-sm">Entradas: Longe e Perto</p>
                    </div>
                    <div class="p-6 space-y-4">
                        <!-- Manual T√©cnico -->
                        <div class="p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg">
                            <h4 class="font-semibold flex items-center gap-2 mb-2 text-slate-900 dark:text-white">
                                <span aria-hidden="true">üìò</span> Manual T√©cnico
                            </h4>
                            <p class="text-sm text-slate-600 dark:text-slate-300 mb-3">
                                A adi√ß√£o corresponde √† diferen√ßa entre a dioptria do esf√©rico para perto e para
                                longe, sendo a principal caracter√≠stica da presbiopia. <strong>Nota: A adi√ß√£o √© sempre
                                    considerada um valor positivo na prescri√ß√£o.</strong>
                            </p>
                            <div
                                class="bg-white dark:bg-slate-900 p-3 rounded border border-slate-200 dark:border-slate-700">
                                <p class="font-mono text-sm text-slate-800 dark:text-slate-200">Adi√ß√£o = Perto ‚àí Longe
                                </p>
                            </div>
                            <p class="text-sm font-medium text-slate-700 dark:text-slate-300 mt-3">Exemplo pr√°tico:</p>
                            <p class="text-sm text-slate-600 dark:text-slate-300">Longe: ‚àí2,00, Perto: +0,50<br>
                                ‚Üì<br>Adi√ß√£o =
                                +0,50 ‚àí (‚àí2,00) = +2,50</p>
                        </div>
                        <!-- F√≥rmula -->
                        <div class="p-4 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20">
                            <h4 class="font-semibold flex items-center gap-2 mb-2 text-slate-900 dark:text-white">
                                <span aria-hidden="true">‚ÑπÔ∏è</span> F√≥rmula
                            </h4>
                            <p class="text-sm text-slate-600 dark:text-slate-300">
                                Calcula a adi√ß√£o subtraindo a dioptria de longe da dioptria de perto. Ex.: Perto +0,50 e
                                Longe ‚àí2,00<br>‚Üì<br>Adi√ß√£o +2,50
                            </p>
                        </div>
                        <!-- Tela de Onboarding (sem t√≠tulo) -->
                        <div
                            class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800">
                            <p class="text-sm text-slate-600 dark:text-slate-300">
                                Informe a dioptria de longe e a de perto para obter automaticamente o valor da adi√ß√£o,
                                calculado pela diferen√ßa entre os dois valores.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Manual Block 2: C√°lculo da Dioptria de Perto -->
                <div id="manual-perto"
                    class="manual-block hidden lg:block bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800">
                    <div class="px-6 py-4 border-b border-slate-100 dark:border-slate-800">
                        <h3 class="font-bold text-lg text-slate-900 dark:text-white">C√°lculo da Dioptria de Perto</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-sm">Entradas: Longe e Adi√ß√£o</p>
                    </div>
                    <div class="p-6 space-y-4">
                        <!-- Manual T√©cnico -->
                        <div class="p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg">
                            <h4 class="font-semibold flex items-center gap-2 mb-2 text-slate-900 dark:text-white">
                                <span aria-hidden="true">üìò</span> Manual T√©cnico
                            </h4>
                            <p class="text-sm text-slate-600 dark:text-slate-300 mb-3">
                                A dioptria de perto √© obtida pela soma da refra√ß√£o de longe com o valor da adi√ß√£o
                                prescrita. <strong>Nota: considerar sempre a adi√ß√£o como valor positivo.</strong>
                            </p>
                            <div
                                class="bg-white dark:bg-slate-900 p-3 rounded border border-slate-200 dark:border-slate-700">
                                <p class="font-mono text-sm text-slate-800 dark:text-slate-200">Perto = Longe + Adi√ß√£o
                                </p>
                            </div>
                            <p class="text-sm font-medium text-slate-700 dark:text-slate-300 mt-3">Exemplo pr√°tico:</p>
                            <p class="text-sm text-slate-600 dark:text-slate-300">Longe: ‚àí1,50, Adi√ß√£o: +2,00<br>
                                ‚Üì<br>Perto
                                =
                                ‚àí1,50 + 2,00 = +0,50</p>
                        </div>
                        <!-- F√≥rmula -->
                        <div class="p-4 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20">
                            <h4 class="font-semibold flex items-center gap-2 mb-2 text-slate-900 dark:text-white">
                                <span aria-hidden="true">‚ÑπÔ∏è</span> F√≥rmula
                            </h4>
                            <p class="text-sm text-slate-600 dark:text-slate-300">
                                Soma a dioptria de longe com a adi√ß√£o para encontrar a dioptria de perto. Ex.: ‚àí1,50 +
                                2,00<br>‚Üì<br>+0,50
                            </p>
                        </div>
                        <!-- Tela de Onboarding (sem t√≠tulo) -->
                        <div
                            class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800">
                            <p class="text-sm text-slate-600 dark:text-slate-300">
                                Utilize este c√°lculo quando a receita informar longe e adi√ß√£o separadamente. A
                                calculadora
                                retorna a dioptria correta para vis√£o de perto.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Manual Block 3: C√°lculo da Dioptria de Longe -->
                <div id="manual-longe"
                    class="manual-block hidden lg:block bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800">
                    <div class="px-6 py-4 border-b border-slate-100 dark:border-slate-800">
                        <h3 class="font-bold text-lg text-slate-900 dark:text-white">C√°lculo da Dioptria de Longe</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-sm">Entradas: Perto e Adi√ß√£o</p>
                    </div>
                    <div class="p-6 space-y-4">
                        <!-- Manual T√©cnico -->
                        <div class="p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg">
                            <h4 class="font-semibold flex items-center gap-2 mb-2 text-slate-900 dark:text-white">
                                <span aria-hidden="true">üìò</span> Manual T√©cnico
                            </h4>
                            <p class="text-sm text-slate-600 dark:text-slate-300 mb-3">
                                A dioptria de longe pode ser determinada subtraindo o valor da adi√ß√£o da refra√ß√£o de
                                perto. <strong>Nota: considerar sempre a adi√ß√£o como valor positivo.</strong>
                            </p>
                            <div
                                class="bg-white dark:bg-slate-900 p-3 rounded border border-slate-200 dark:border-slate-700">
                                <p class="font-mono text-sm text-slate-800 dark:text-slate-200">Longe = Perto ‚àí Adi√ß√£o
                                </p>
                            </div>
                            <p class="text-sm font-medium text-slate-700 dark:text-slate-300 mt-3">Exemplo pr√°tico:</p>
                            <p class="text-sm text-slate-600 dark:text-slate-300">Perto: +1,00, Adi√ß√£o: +2,50<br>
                                ‚Üì<br>Longe
                                =
                                +1,00 ‚àí 2,50 = ‚àí1,50</p>
                        </div>
                        <!-- F√≥rmula -->
                        <div class="p-4 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20">
                            <h4 class="font-semibold flex items-center gap-2 mb-2 text-slate-900 dark:text-white">
                                <span aria-hidden="true">‚ÑπÔ∏è</span> F√≥rmula
                            </h4>
                            <p class="text-sm text-slate-600 dark:text-slate-300">
                                Subtraia a adi√ß√£o da dioptria de perto para obter a dioptria de longe. Ex.: +1,00 ‚àí 2,50
                                <br>‚Üì<br>‚àí1,50
                            </p>
                        </div>
                        <!-- Tela de Onboarding (sem t√≠tulo) -->
                        <div
                            class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800">
                            <p class="text-sm text-slate-600 dark:text-slate-300">
                                Este c√°lculo √© indicado quando a prescri√ß√£o apresenta apenas a refra√ß√£o para perto e o
                                valor da adi√ß√£o.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer class="p-6 text-center text-slate-800 dark:text-slate-300 text-xs mt-auto">
        <p>¬© 2026 Calculadora Master. Desenvolvida para Profissionais de √ìptica.</p>
    </footer>

    <script>
        // Custom Dropdown Functions
        function generateDropdownOptions(isAddition = false) {
            const options = {
                negatives: [],
                zero: [{ value: '0.00', display: '0,00' }],
                positives: []
            };

            // For "Adi√ß√£o" dropdown, only show positive numbers from 0.00 to +6.00
            if (isAddition) {
                options.zero = []; // No separate zero section for addition
                for (let i = 0; i <= 6; i += 0.25) {
                    options.positives.push({
                        value: i.toFixed(2),
                        display: formatDropdownNumber(i)
                    });
                }
            } else {
                // For other dropdowns, show full range from -25.00 to +25.00
                for (let i = -25; i < 0; i += 0.25) {
                    options.negatives.push({
                        value: i.toFixed(2),
                        display: formatDropdownNumber(i)
                    });
                }

                for (let i = 0.25; i <= 25; i += 0.25) {
                    options.positives.push({
                        value: i.toFixed(2),
                        display: formatDropdownNumber(i)
                    });
                }
            }

            return options;
        }

        function formatDropdownNumber(num) {
            const formatted = num.toFixed(2).replace('.', ',');
            return num >= 0 ? `+${formatted}` : formatted;
        }

        function initDropdown(dropdownId, isAddition = false) {
            const dropdown = document.querySelector(`[data-dropdown-id="${dropdownId}"]`);
            if (!dropdown) return;

            const trigger = dropdown.querySelector('.dropdown-trigger');
            const menu = dropdown.querySelector('.dropdown-menu');
            const selectedValueSpan = dropdown.querySelector('.selected-value');
            const hiddenInput = dropdown.querySelector('input[type="hidden"]');

            // Generate options
            const options = generateDropdownOptions(isAddition);

            // Remove 'Input' suffix from dropdownId to match container IDs
            const containerIdPrefix = dropdownId.replace('Input', '');

            // Populate negative options using specific ID
            const negativeContainer = document.getElementById(`${containerIdPrefix}Negatives`);
            if (negativeContainer) {
                options.negatives.forEach(opt => {
                    const option = document.createElement('div');
                    option.className = 'dropdown-option';
                    option.textContent = opt.display;
                    option.dataset.value = opt.value;
                    option.addEventListener('click', () => selectOption(dropdown, opt));
                    negativeContainer.appendChild(option);
                });

                // Hide negative section if no options (for addition dropdown)
                if (options.negatives.length === 0) {
                    const negativeSection = dropdown.querySelector('.dropdown-section:nth-child(1)');
                    if (negativeSection) {
                        negativeSection.style.display = 'none';
                    }
                }
            }

            // Populate zero options using specific ID
            const zeroContainer = document.getElementById(`${containerIdPrefix}Zero`);
            if (zeroContainer) {
                options.zero.forEach(opt => {
                    const option = document.createElement('div');
                    option.className = 'dropdown-option selected';
                    option.textContent = opt.display;
                    option.dataset.value = opt.value;
                    option.addEventListener('click', () => selectOption(dropdown, opt));
                    zeroContainer.appendChild(option);
                });
            }

            // Populate positive options using specific ID
            const positiveContainer = document.getElementById(`${containerIdPrefix}Positives`);
            if (positiveContainer) {
                options.positives.forEach(opt => {
                    const option = document.createElement('div');
                    option.className = 'dropdown-option';
                    option.textContent = opt.display;
                    option.dataset.value = opt.value;
                    option.addEventListener('click', () => selectOption(dropdown, opt));
                    positiveContainer.appendChild(option);
                });
            }

            // Toggle dropdown
            trigger.addEventListener('click', (e) => {
                e.stopPropagation();
                menu.classList.toggle('open');
                trigger.classList.toggle('open');
                if (menu.classList.contains('open')) {
                    // Scroll to zero option to center it in the middle
                    const zeroOption = menu.querySelector('.dropdown-option[data-value="0.00"]');
                    if (zeroOption) {
                        const menuHeight = menu.clientHeight;
                        const zeroOffset = zeroOption.offsetTop;
                        menu.scrollTop = zeroOffset - (menuHeight / 2) + (zeroOption.clientHeight / 2);
                    }
                }
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!dropdown.contains(e.target)) {
                    menu.classList.remove('open');
                    trigger.classList.remove('open');
                }
            });

            // Select default value
            if (options.zero.length > 0) {
                selectOption(dropdown, options.zero[0]);
            } else if (options.positives.length > 0) {
                // For addition dropdown, select the first positive (0.00)
                selectOption(dropdown, options.positives[0]);
            }
        }

        function selectOption(dropdown, option) {
            const selectedValueSpan = dropdown.querySelector('.selected-value');
            const hiddenInput = dropdown.querySelector('input[type="hidden"]');
            const menu = dropdown.querySelector('.dropdown-menu');
            const trigger = dropdown.querySelector('.dropdown-trigger');

            // Update selected value display
            selectedValueSpan.textContent = option.display;

            // Update hidden input
            hiddenInput.value = option.value;

            // Update selected class
            dropdown.querySelectorAll('.dropdown-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            const selectedOption = dropdown.querySelector(`.dropdown-option[data-value="${option.value}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }

            // Trigger change event
            hiddenInput.dispatchEvent(new Event('change', { bubbles: true }));
        }

        function resetDropdown(dropdownId) {
            const dropdown = document.querySelector(`[data-dropdown-id="${dropdownId}"]`);
            if (!dropdown) return;

            const selectedValueSpan = dropdown.querySelector('.selected-value');
            const hiddenInput = dropdown.querySelector('input[type="hidden"]');

            // Reset to default value (0,00)
            selectedValueSpan.textContent = '0,00';
            hiddenInput.value = '0.00';

            // Update selected class
            dropdown.querySelectorAll('.dropdown-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            const selectedOption = dropdown.querySelector(`.dropdown-option[data-value="0.00"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }

            // Trigger change event
            hiddenInput.dispatchEvent(new Event('change', { bubbles: true }));
        }

        // Initialize dropdowns when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            // C√°lculo de Adi√ß√£o block (both inputs have full range -25.00 to +25.00)
            initDropdown('addLongeInput', false);  // Longe: full range
            initDropdown('addPertoInput', false);  // Perto: full range

            // C√°lculo de Perto block (Longe: full range, Adi√ß√£o: positive only 0.00 to +6.00)
            initDropdown('nearLongeInput', false);  // Longe: full range
            initDropdown('nearAddInput', true);   // Adi√ß√£o: positive only (0.00 to +6.00)

            // C√°lculo de Longe block (Perto: full range, Adi√ß√£o: positive only 0.00 to +6.00)
            initDropdown('farPertoInput', false);  // Perto: full range
            initDropdown('farAddInput', true);    // Adi√ß√£o: positive only (0.00 to +6.00)
        });

        // Get DOM elements
        const addLongeInput = document.getElementById('addLongeInput');
        const addPertoInput = document.getElementById('addPertoInput');
        const addResult = document.getElementById('addResult');
        const calcAddBtn = document.getElementById('calcAddBtn');
        const addLongeError = document.getElementById('addLongeError');
        const addPertoError = document.getElementById('addPertoError');

        const nearLongeInput = document.getElementById('nearLongeInput');
        const nearAddInput = document.getElementById('nearAddInput');
        const nearResult = document.getElementById('nearResult');
        const calcNearBtn = document.getElementById('calcNearBtn');
        const nearLongeError = document.getElementById('nearLongeError');
        const nearAddError = document.getElementById('nearAddError');

        const farPertoInput = document.getElementById('farPertoInput');
        const farAddInput = document.getElementById('farAddInput');
        const farResult = document.getElementById('farResult');
        const calcFarBtn = document.getElementById('calcFarBtn');
        const farPertoError = document.getElementById('farPertoError');
        const farAddError = document.getElementById('farAddError');

        const resetAllBtn = document.getElementById('resetAllBtn');

        // Mobile/Tablet Dropdown Elements
        const calcSelector = document.getElementById('calcSelector');
        const calcBlocks = document.querySelectorAll('.calc-block');
        const manualBlocks = document.querySelectorAll('.manual-block');

        // Function to show/hide blocks based on dropdown selection
        function handleCalcSelectorChange() {
            const selectedValue = calcSelector.value;

            // Hide all calculator blocks and manual sections on mobile/tablet
            calcBlocks.forEach(block => {
                block.classList.remove('flex');
                block.classList.add('hidden');
            });
            manualBlocks.forEach(block => {
                block.classList.remove('block');
                block.classList.add('hidden');
            });

            // Show only the selected calculator block and its corresponding manual section
            if (selectedValue) {
                const calcBlock = document.getElementById(`calc-${selectedValue}`);
                const manualBlock = document.getElementById(`manual-${selectedValue}`);

                if (calcBlock) {
                    calcBlock.classList.remove('hidden');
                    calcBlock.classList.add('flex');
                }
                if (manualBlock) {
                    manualBlock.classList.remove('hidden');
                    manualBlock.classList.add('block');
                }
            }
        }

        // Add event listener for dropdown change
        calcSelector.addEventListener('change', handleCalcSelectorChange);

        // Initialize: Show "C√°lculo de Adi√ß√£o" by default on mobile/tablet
        handleCalcSelectorChange();

        // Parse input accepting both comma and dot as decimal separator
        function parseInput(value) {
            if (!value || value.trim() === '') return null;

            let normalized = value.replace(',', '.');

            // If no decimal point, insert it before the last 2 digits
            if (!normalized.includes('.')) {
                if (normalized.length >= 2) {
                    const intPart = normalized.slice(0, -2);
                    const decPart = normalized.slice(-2);
                    normalized = intPart + '.' + decPart;
                } else if (normalized.length === 1) {
                    normalized = '0.' + normalized.padStart(2, '0');
                }
            }

            const num = parseFloat(normalized);
            return isNaN(num) ? null : num;
        }

        // Check if value contains letters (a-z, A-Z)
        function containsLetters(value) {
            return /[a-zA-Z]/.test(value);
        }

        // Validate if value is a valid 0.25 increment
        function isValidStep(value) {
            const num = parseInput(value);
            if (num === null) return false;
            // Check if divisible by 0.25 by multiplying by 4 and checking if result is integer
            return (Math.abs(num) * 4) % 1 === 0;
        }

        // Format number with comma separator and 2 decimal places
        function formatNumberWithComma(num) {
            return num.toFixed(2).replace('.', ',');
        }

        // Format number with proper sign
        function formatNumber(num) {
            const sign = num >= 0 ? '+' : '';
            return sign + formatNumberWithComma(num);
        }

        // Format addition result (always positive)
        function formatAddition(num) {
            const absNum = Math.abs(num);
            return 'ADD ' + formatNumber(absNum);
        }

        // Show error for an input field
        function showError(input, errorElement) {
            input.classList.add('input-error');
            errorElement.classList.remove('hidden');
        }

        // Hide error for an input field
        function hideError(input, errorElement) {
            input.classList.remove('input-error');
            errorElement.classList.add('hidden');
        }

        // Validate and format input on change
        function validateAndFormatInput(input, errorElement) {
            const value = input.value;

            // If empty, hide error and return
            if (!value || value.trim() === '') {
                hideError(input, errorElement);
                return null;
            }

            // Check if contains letters - show error immediately
            if (containsLetters(value)) {
                errorElement.textContent = 'Apenas n√∫meros permitidos';
                showError(input, errorElement);
                return null;
            }

            // Check if valid 0.25 increment
            if (!isValidStep(value)) {
                errorElement.textContent = 'Valor inv√°lido';
                showError(input, errorElement);
                return null;
            } else {
                hideError(input, errorElement);
                return parseInput(value);
            }
        }


        // Format input on blur (Rule 2: format single digit to X,00)
        function formatInputOnBlur(input, errorElement) {
            const value = input.value;

            // If empty, just hide error
            if (!value || value.trim() === '') {
                hideError(input, errorElement);
                return;
            }

            // Check if contains letters - show error immediately
            if (containsLetters(value)) {
                errorElement.textContent = 'Apenas n√∫meros permitidos';
                showError(input, errorElement);
                return;
            }

            // Rule 2: If input is a single digit, format as X,00
            const trimmedValue = value.trim();
            if (/^\d$/.test(trimmedValue)) {
                // Single digit (without sign)
                const num = parseFloat(trimmedValue);
                input.value = formatNumberWithComma(num);
                hideError(input, errorElement);
                return;
            }

            // Validate and format
            if (isValidStep(value)) {
                const num = parseInput(value);
                input.value = formatNumber(num);
                hideError(input, errorElement);
            } else {
                errorElement.textContent = 'Valor inv√°lido';
                showError(input, errorElement);
            }
        }

        // Calculate Addition: Perto - Longe = Adi√ß√£o
        function calculateAddition() {
            const longe = parseFloat(addLongeInput.value);
            const perto = parseFloat(addPertoInput.value);

            if (isNaN(longe) || isNaN(perto)) {
                return; // Don't calculate if inputs are invalid
            }

            const addition = Math.abs(perto - longe);
            addResult.textContent = formatAddition(addition);
        }

        // Calculate Near: Longe + Adi√ß√£o = Perto
        function calculateNear() {
            const longe = parseFloat(nearLongeInput.value);
            const addition = parseFloat(nearAddInput.value);

            if (isNaN(longe) || isNaN(addition)) {
                return; // Don't calculate if inputs are invalid
            }

            // Addition value is always positive
            const near = longe + Math.abs(addition);
            nearResult.textContent = formatNumber(near);
        }

        // Calculate Far: Perto - Adi√ß√£o = Longe
        function calculateFar() {
            const perto = parseFloat(farPertoInput.value);
            const addition = parseFloat(farAddInput.value);

            if (isNaN(perto) || isNaN(addition)) {
                return; // Don't calculate if inputs are invalid
            }

            // Addition value is always positive
            const far = perto - Math.abs(addition);
            farResult.textContent = formatNumber(far);
        }

        // Reset all inputs and results
        function resetAll() {
            // Reset Addition calculator
            resetDropdown('addLongeInput');
            resetDropdown('addPertoInput');
            addResult.textContent = 'ADD +0,00';
            hideError(addLongeInput, addLongeError);
            hideError(addPertoInput, addPertoError);

            // Reset Near calculator
            resetDropdown('nearLongeInput');
            resetDropdown('nearAddInput');
            nearResult.textContent = '+0,00';
            hideError(nearLongeInput, nearLongeError);
            hideError(nearAddInput, nearAddError);

            // Reset Far calculator
            resetDropdown('farPertoInput');
            resetDropdown('farAddInput');
            farResult.textContent = '+0,00';
            hideError(farPertoInput, farPertoError);
            hideError(farAddInput, farAddError);
        }

        // Add event listeners
        calcAddBtn.addEventListener('click', calculateAddition);
        calcNearBtn.addEventListener('click', calculateNear);
        calcFarBtn.addEventListener('click', calculateFar);
        resetAllBtn.addEventListener('click', resetAll);

        // Add input validation listeners for real-time validation
        const allInputs = [
            { input: nearLongeInput, error: nearLongeError },
            { input: farPertoInput, error: farPertoError }
        ];

        allInputs.forEach(({ input, error }) => {
            // Format on blur
            input.addEventListener('blur', () => {
                formatInputOnBlur(input, error);
            });

            // Check for letters in real-time on input (for all inputs)
            input.addEventListener('input', () => {
                const value = input.value;

                // If empty, hide error and return
                if (!value || value.trim() === '') {
                    if (error.textContent === 'Apenas n√∫meros permitidos') {
                        hideError(input, error);
                        error.textContent = 'Valor inv√°lido';
                    }
                    return;
                }

                // Check if value contains letters - immediately reject
                if (containsLetters(value)) {
                    error.textContent = 'Apenas n√∫meros permitidos';
                    showError(input, error);
                } else if (error.textContent === 'Apenas n√∫meros permitidos') {
                    // If no letters and error is the letters error, hide it
                    hideError(input, error);
                    error.textContent = 'Valor inv√°lido';
                }

            });

            // Allow Enter key to trigger calculations
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    // Determine which calculation to trigger based on input
                    if (input === addLongeInput || input === addPertoInput) {
                        calculateAddition();
                    } else if (input === nearLongeInput || input === nearAddInput) {
                        calculateNear();
                    } else if (input === farPertoInput || input === farAddInput) {
                        calculateFar();
                    }
                }
            });
        });

        // Function to toggle sign of input value
        function toggleSign(input, toggleBtn, errorElement) {
            const value = input.value.trim();

            // If empty, do nothing
            if (!value) {
                return;
            }

            // Check if contains letters - don't toggle
            if (containsLetters(value)) {
                return;
            }

            // Parse the value
            const num = parseInput(value);
            if (num === null) {
                return;
            }

            // Toggle the sign
            const toggledNum = -num;

            // Update the input value
            input.value = formatNumber(toggledNum);

            // Update the toggle button text
            toggleBtn.textContent = toggledNum >= 0 ? '+' : '-';

            // Hide any existing errors
            hideError(input, errorElement);

            // Trigger input event to update validation
            input.dispatchEvent(new Event('input'));
        }

    </script>
</body>

</html>